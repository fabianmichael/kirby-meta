(function(){"use strict";function c(s,e,t,i,n,o,_,L){var a=typeof s=="function"?s.options:s;e&&(a.render=e,a.staticRenderFns=t,a._compiled=!0),i&&(a.functional=!0),o&&(a._scopeId="data-v-"+o);var r;if(_?(r=function(l){l=l||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!l&&typeof __VUE_SSR_CONTEXT__<"u"&&(l=__VUE_SSR_CONTEXT__),n&&n.call(this,l),l&&l._registeredComponents&&l._registeredComponents.add(_)},a._ssrRegister=r):n&&(r=L?function(){n.call(this,(a.functional?this.parent:this).$root.$options.shadowRoot)}:n),r)if(a.functional){a._injectStyles=r;var T=a.render;a.render=function(V,h){return r.call(h),T(V,h)}}else{var m=a.beforeCreate;a.beforeCreate=m?[].concat(m,r):[r]}return{exports:s,options:a}}const g={props:{blueprint:String,lock:[Boolean,Object],help:String,name:String,parent:String,timestamp:Number},data(){return{headline:"Basic Meta Information",metadata_og_image:null,metadata_og_image_field:null,page_is_homepage:null,page_title:null,page_metadata_description:null,site_meta_description:null,site_name:null,site_og_image:null,site_title:null,title_separator:null,url:null,og_title_prefix:null,og_image:null,og_image_source:null}},async created(){const s=await this.load();this.headline=s.headline,this.metadata_og_image=s.metadata_og_image,this.metadata_og_image_field=s.metadata_og_image_field,this.page_is_homepage=s.page_is_homepage,this.page_title=s.page_title,this.page_metadata_description=s.page_metadata_description,this.site_meta_description=s.site_meta_description,this.site_name=s.site_name,this.site_og_image=s.site_og_image,this.site_title=s.site_title,this.title_separator=s.title_separator,this.og_title_prefix=s.og_title_prefix,this.url=s.url,this.updateOgImage()},computed:{title(){const{og_title:s,meta_title:e}=this.$store.getters["content/values"](),t=this.og_title_prefix||"",i=this.page_is_homepage?s||e||this.site_name:s||e||this.page_title;return t+i},description(){const{og_description:s,meta_description:e}=this.$store.getters["content/values"]();return s||e||this.page_metadata_description||this.site_meta_description||this.$t("fabianmichael.meta.description_missing")},store_image(){return this.$store.getters["content/values"]().og_image}},watch:{store_image:{handler(){this.updateOgImage()},immediate:!0}},methods:{load(){return this.$api.get(this.parent+"/sections/"+this.name)},updateOgImage(){this.store_image.length>0?this.$api.files.get(this.$store.getters["content/model"]().api,this.store_image[0].filename,{view:"compact"}).then(s=>{this.og_image=s.url,this.og_image_source=this.$t("fabianmichael.meta.source.og_image")}):this.metadata_og_image!==null?(this.og_image=this.metadata_og_image.url,this.og_image_source=this.$t("fabianmichael.meta.source.metadata")):this.site_og_image!==null?(this.og_image=this.site_og_image.url,this.og_image_source=this.$t("fabianmichael.meta.source.site")):this.og_image=null}}};var p=function(){var e=this,t=e._self._c;return t("k-section",{staticClass:"k-meta-sharing-preview"},[t("div",{staticClass:"k-meta-sharing-preview__label k-field-label"},[t("k-icon",{attrs:{type:"share"}}),t("k-label",[e._v(e._s(e.headline))])],1),t("div",{staticClass:"k-meta-sharing-preview__box"},[t("div",{staticClass:"k-meta-sharing-preview__image-container",attrs:{"data-image-missing":!e.og_image,"data-image-missing-text":e.$t("fabianmichael.meta.og_image.missing")}},[e.og_image?t("img",{staticClass:"k-meta-sharing-preview__preview-image",attrs:{src:e.og_image}}):e._e(),e.og_image_source?t("span",{staticClass:"k-meta-sharing-preview__source-badge"},[e._v(e._s(e.og_image_source))]):e._e()]),t("div",{staticClass:"k-meta-sharing-preview__content-container"},[t("span",{staticClass:"k-meta-sharing-preview__site-name"},[e._v(e._s(e.site_name))]),t("h2",{staticClass:"k-meta-sharing-preview__preview-headline"},[e._v(" "+e._s(e.title)+" ")]),t("p",{staticClass:"k-meta-sharing-preview__preview-paragraph"},[e._v(" "+e._s(e.description)+" ")])])])])},d=[],u=c(g,p,d,!1,null,null,null,null);const v=u.exports,k={data(){return{showFavicon:!1}},props:{siteTitle:String,separator:String,label:String,modelTitle:String,isHomePage:Boolean,theme:{default:()=>"field",type:String}},computed:{separatorPreview(){return this.$store.getters["content/values"]().meta_title_separator||this.separator},title(){const s=this.$store.getters["content/values"]();return this.isHomePage?s.meta_title||this.siteTitle:s.meta_title||this.modelTitle||this.$t("fabianmichael.meta.page_title.placeholder")}}};var f=function(){var e=this,t=e._self._c;return t("k-field",e._b({staticClass:"k-meta-title-preview"},"k-field",e.$props,!1),[t("div",{staticClass:"k-meta-title-preview__content"},[t("img",{staticClass:"k-k-meta-title-separator-preview__favicon",attrs:{alt:"",width:"16",height:"16",src:e.$urls.site+"/favicon.ico",hidden:!e.showFavicon},on:{error:function(i){e.showFavicon=!1},load:function(i){e.showFavicon=!0}}}),e.showFavicon?e._e():t("k-icon",{attrs:{type:"globe"}}),t("div",{staticClass:"k-meta-title-preview__title"},[t("span",[e._v(e._s(e.title))]),e._v(" "),e.isHomePage?e._e():t("span",{staticClass:"k-meta-title-preview__separator"},[e._v(e._s(e.separatorPreview))]),e._v(" "),e.isHomePage?e._e():t("span",[e._v(e._s(e.siteTitle))])])],1)])},C=[],w=c(k,f,C,!1,null,null,null,null);const b=w.exports,y={props:{dir:String,sort:String,pages:Object},data(){return{isBusy:!1}},methods:{async checkInternalLinks(){this.isBusy=!0;for(let s=0,e=this.pages.length;s<e;s++){const t=this.pages[s];t.internalLinksResult=null,this.$set(this.pages,s,t)}for(let s=0,e=this.pages.length;s<e;s++){const t=this.pages[s],i=t.id,n=await this.$api.get("meta/check-internal-links",{id:i,language:this.$multilang?this.$language.code:null});t.internalLinksResult=n,this.$set(this.pages,s,t)}this.isBusy=!1}}};var $=function(){var e=this,t=e._self._c;return t("k-inside",[t("k-view",[t("k-header",[e._v(" Metadata "),t("k-button-group",{attrs:{slot:"left"},slot:"left"},[t("k-button",{attrs:{text:"Validate internal links",icon:"wand",disabled:e.isBusy},on:{click:e.checkInternalLinks}}),t("k-languages-dropdown")],1)],1),t("table",{staticClass:"k-meta"},[t("thead",[t("tr",[t("th",[t("span",{staticClass:"k-meta-title"},[t("span",{staticClass:"k-meta-caps"},[e._v("Title Override")])])]),t("th",[t("span",{staticClass:"k-meta-title"},[t("span",{staticClass:"k-meta-caps"},[e._v("Meta Description")])])]),t("th",[t("span",{staticClass:"k-meta-title"},[t("span",{staticClass:"k-meta-caps"},[e._v("Share Title")])])]),t("th",{staticStyle:{width:"14rem"}},[t("span",{staticClass:"k-meta-title"},[t("span",{staticClass:"k-meta-caps"},[e._v("Share Description")])])]),t("th",{staticClass:"k-meta-thumbnail-col"},[t("k-icon",{attrs:{type:"image"}})],1),t("th",{staticStyle:{width:"14rem"}},[t("span",{staticClass:"k-meta-title"},[t("k-icon",{attrs:{type:"image"}}),t("span",{staticClass:"k-meta-caps"},[e._v("Alt")])],1)]),t("th",{staticStyle:{width:"3rem"}},[t("span",{staticClass:"sr-only"},[e._v("Robots")]),t("k-icon",{attrs:{type:"meta-robot"}})],1),t("th",{staticStyle:{width:"3rem"}},[t("span",{staticClass:"sr-only"},[e._v("Link validation")]),t("k-icon",{attrs:{type:"url"}})],1)])]),t("tbody",[e._l(e.pages,function(i,n){return[t("tr",{key:n+"_head",attrs:{"data-is-indexible":i.is_indexible}},[t("th",{staticClass:"k-meta-page-header-col",attrs:{colspan:"8"}},[t("div",{staticClass:"k-meta-page-header"},[t("div",{staticClass:"k-meta-status-wrap"},[t("k-status-icon",{attrs:{status:i.status}})],1),t("k-link",{attrs:{to:i.panelUrl}},[e._v(e._s(i.title))]),t("a",{staticClass:"k-meta-infozone",attrs:{href:i.url,target:"_blank",rel:"noopener"}},[t("k-icon",{attrs:{type:"url"}}),t("span",[e._v(e._s(i.shortUrl))])],1),t("span",{staticClass:"k-meta-infozone"},[t("k-icon",{attrs:{type:i.icon||"page"}}),t("span",[e._v(e._s(i.template))])],1)],1)])]),t("tr",{key:n+"_content",attrs:{"data-is-indexible":i.is_indexible}},[t("td",[i.meta_title?t("div",{staticClass:"k-meta-text-xs k-meta-max-3-lines"},[e._v(e._s(i.meta_title))]):[e._v("—")]],2),t("td",[i.meta_description?t("div",{staticClass:"k-meta-text-xs k-meta-max-3-lines"},[e._v(e._s(i.meta_description))]):[e._v("—")]],2),t("td",[i.og_title?t("div",{staticClass:"k-meta-text-xs k-meta-max-3-lines"},[e._v(e._s(i.og_title))]):[e._v("—")]],2),t("td",[i.og_description?t("div",{staticClass:"k-meta-text-xs k-meta-max-3-lines"},[e._v(e._s(i.og_description))]):i.meta_description?t("div",{staticClass:"k-meta-text-xs k-meta-max-3-lines",staticStyle:{opacity:"0.5"}},[e._v("[Meta description]")]):[e._v("—")]],2),t("td",{staticClass:"k-meta-thumbnail-col"},[i.og_image_url?t("k-image",{attrs:{src:i.og_image_url,cover:!0,ratio:"1200/630",back:"pattern"}}):t("div",{staticClass:"k-meta-center"},[e._v("—")])],1),t("td",[i.og_image_alt?t("div",{staticClass:"k-meta-text-xs k-meta-max-3-lines"},[e._v(e._s(i.og_image_alt))]):[e._v("—")]],2),t("td",[t("div",{staticClass:"k-meta-center"},[t("k-icon",{attrs:{type:i.is_indexible?"meta-true":"meta-false"}})],1)]),t("td",[t("div",{staticClass:"k-meta-center"},[i.internalLinksResult?t("k-icon",{attrs:{type:i.internalLinksResult&&i.internalLinksResult.message?"meta-false":"meta-true"}}):[e._v("—")]],2)])]),i.internalLinksResult&&i.internalLinksResult.message?t("tr",{key:n+"_internal_links_result"},[t("td",{staticClass:"k-meta-result",attrs:{colspan:"8"}},[t("k-box",{attrs:{theme:"negative"}},[t("k-text",{attrs:{size:"tiny"}},[t("p",[e._v(e._s(i.internalLinksResult.message))]),i.internalLinksResult.brokenLinks?t("ul",e._l(i.internalLinksResult.brokenLinks,function(o,_){return t("li",{key:_,domProps:{innerHTML:e._s(o)}})}),0):e._e()])],1)],1)]):e._e()]})],2)])],1)],1)},x=[],S=c(y,$,x,!1,null,null,null,null);const R=S.exports;panel.plugin("fabianmichael/meta",{components:{"k-meta-view":R},fields:{"meta-title-preview":b},sections:{"meta-share-preview":v},icons:{"meta-true":'<g fill="currentColor"><polygon points="12.4,6 11,4.6 7,8.6 5,6.6 3.6,8 7,11.4 "></polygon></g>',"meta-false":'<g fill="currentColor"><polygon points="10.1,4.5 8,6.6 5.9,4.5 4.5,5.9 6.6,8 4.5,10.1 5.9,11.5 8,9.4 10.1,11.5 11.5,10.1 9.4,8 11.5,5.9 "></polygon></g>',"meta-robot":'<g fill="currentColor"><path d="M10,0v2h2v2H4V2h2V0H0v2h2v2H0v12h16V4h-2V2h2V0H10z M14,14H2V6h2h8h2V14z"></path><rect x="4" y="7" width="3" height="2"></rect><rect x="9" y="7" width="3" height="2"></rect><rect x="5" y="10" width="6" height="3"></rect>'}})})();
